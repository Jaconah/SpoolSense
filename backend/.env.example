# ============================================================================
# Filament Manager - Multi-Tenant SaaS Configuration
# ============================================================================

# ============================================================================
# Database Configuration
# ============================================================================

# Legacy single-tenant database (kept for backwards compatibility)
DATABASE_URL=sqlite:///./data/filament_manager.db

# Multi-tenant configuration
METADATA_DB_URL=sqlite:///./data/tenants/metadata.db
TENANT_DATA_DIR=./data/tenants

# ============================================================================
# Security & Authentication
# ============================================================================

# General secret key (legacy)
SECRET_KEY=change-me-to-a-random-string-min-32-chars

# JWT secret key for user tokens (IMPORTANT: Use a different key than SECRET_KEY)
# Generate with: python -c "import secrets; print(secrets.token_urlsafe(32))"
JWT_SECRET_KEY=change-me-to-a-different-random-string-min-32-chars

# JWT secret key for admin tokens (MUST be different from JWT_SECRET_KEY)
# Generate with: python -c "import secrets; print(secrets.token_urlsafe(32))"
ADMIN_JWT_SECRET_KEY=change-me-to-a-separate-admin-jwt-secret-min-32-chars

JWT_ALGORITHM=HS256
ACCESS_TOKEN_EXPIRE_MINUTES=15
REFRESH_TOKEN_EXPIRE_DAYS=7

# ============================================================================
# Email Configuration (SMTP2GO)
# ============================================================================

SMTP_HOST=mail.smtp2go.com
SMTP_PORT=2525
SMTP_USER=filly-bot_thing
SMTP_PASSWORD=eg5j5Le54NiKbGFN
SMTP_FROM=noreply@rquinn.net
# ============================================================================
# Cloudflare Turnstile (CAPTCHA)
# ============================================================================

# Get keys from: https://dash.cloudflare.com/turnstile
CLOUDFLARE_TURNSTILE_SECRET=your-turnstile-secret-key

# ============================================================================
# Admin Configuration
# ============================================================================

# Default admin account (created on first run)
ADMIN_EMAIL=admin@yourdomain.com

# Admin password hash (generate with script below)
# Generate with: python -c "import bcrypt; print(bcrypt.hashpw(b'your-password-here', bcrypt.gensalt()).decode())"
# Or run: python scripts/generate_secrets.py
ADMIN_PASSWORD_HASH=

# ============================================================================
# Application Configuration
# ============================================================================

ENVIRONMENT=development

# Production frontend URL for CORS (leave empty for development)
# Example: https://yourdomain.com
FRONTEND_URL=

# ============================================================================
# Instructions
# ============================================================================

# 1. Copy this file to .env: cp .env.example .env
# 2. Generate SECRET_KEY, JWT_SECRET_KEY, and ADMIN_JWT_SECRET_KEY (all different):
#    python -c "import secrets; print(secrets.token_urlsafe(32))"
# 3. Generate ADMIN_PASSWORD_HASH:
#    python -c "import bcrypt; print(bcrypt.hashpw(b'YourSecurePassword123!', bcrypt.gensalt()).decode())"
# 4. Sign up for SMTP2GO and add credentials
# 5. Sign up for Cloudflare Turnstile and add secret key
# 6. Update SMTP_FROM with your domain
# 7. Update ADMIN_EMAIL with your email
# 8. In production, set ENVIRONMENT=production and FRONTEND_URL

# ============================================================================
# Running Migrations
# ============================================================================

# Tenant database migrations (existing):
#   alembic upgrade head

# Metadata database migrations (new - for users/admin):
#   alembic -c alembic_metadata.ini upgrade head

# ============================================================================
# Creating First Admin User
# ============================================================================

# Option 1: Set ADMIN_EMAIL and ADMIN_PASSWORD_HASH in .env
#   - App will create admin on first startup
#
# Option 2: Create manually via Python:
#   python -c "
#   from app.database import MetadataSessionLocal
#   from app.models.auth import AdminUser
#   from app.services.auth import hash_password
#   db = MetadataSessionLocal()
#   admin = AdminUser(email='admin@example.com', password_hash=hash_password('YourPassword123!'))
#   db.add(admin)
#   db.commit()
#   print('Admin created!')
#   "
